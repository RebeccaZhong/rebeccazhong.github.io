# 本地配置maven私库后无法下载私库所包含的jar包问题

## 问题描述

maven所在的settings.xml中配置了私库的地址，确认配置信息无误，在执行 `mvn clean install -DskipTests` 命令时，报 `http://localhost:8081/nexus/content/groups/public` 这个url不通。实际在maven的 `conf` 文件夹下 `settings.conf` 中配置的url是 `http://192.168.9.27:8081/nexus/content/groups/public`。

## 原因排查

执行 `mvn help:effective-settings` 命令查看当前maven生效的配置文件。看到结果如下：

```xml
[INFO]
Effective user-specific configuration settings:

<?xml version="1.0" encoding="GBK"?>
<!-- ====================================================================== -->
<!--                                                                        -->
<!-- Generated by Maven Help Plugin on 2019-10-18T16:44:19+08:00            -->
<!-- See: http://maven.apache.org/plugins/maven-help-plugin/                -->
<!--                                                                        -->
<!-- ====================================================================== -->
<!-- ====================================================================== -->
<!--                                                                        -->
<!-- Effective Settings for 'lenovo' on 'Archer'                            -->
<!--                                                                        -->
<!-- ====================================================================== -->
<settings xmlns="http://maven.apache.org/SETTINGS/1.1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.1.0 http://maven.apache.org/xsd/settings-1.1.0.xsd">
  <localRepository>E:\home\.m2\repository</localRepository>
  <servers>
    <server>
      <username>admin</username>
      <password>***</password>
      <id>releases</id>
    </server>
    <server>
      <username>admin</username>
      <password>***</password>
      <id>snapshots</id>
    </server>
    <server>
      <username>admin</username>
      <password>***</password>
      <id>nexus</id>
    </server>
    <server>
      <username>admin</username>
      <password>***</password>
      <id>thirdparty</id>
    </server>
  </servers>
  <mirrors>
    <mirror>
      <mirrorOf>*</mirrorOf>
      <url>http://localhost:8081/nexus/content/groups/public</url>
      <id>nexus</id>
    </mirror>
    <mirror>
      <mirrorOf>central</mirrorOf>
      <name>Nexus aliyun</name>
      <url>http://maven.aliyun.com/nexus/content/groups/public</url>
      <id>nexus-aliyun</id>
    </mirror>
    <mirror>
      <mirrorOf>central</mirrorOf>
      <name>Nexus pentaho</name>
      <url>https://nexus.pentaho.org/content/repositories/omni/</url>
      <id>nexus-pentaho</id>
    </mirror>
  </mirrors>
  <profiles>
    <profile>
      <repositories>
        <repository>
          <releases />
          <snapshots />
          <id>central</id>
          <url>http://central</url>
        </repository>
      </repositories>
      <pluginRepositories>
        <pluginRepository>
          <releases />
          <snapshots />
          <id>central</id>
          <url>http://central</url>
        </pluginRepository>
      </pluginRepositories>
      <id>nexus</id>
    </profile>
    <profile>
      <repositories>
        <repository>
          <snapshots />
          <id>maven.default</id>
          <name>default maven repository</name>
          <url>http://repo1.maven.org/maven2</url>
        </repository>
        <repository>
          <snapshots />
          <id>maven.snapshot</id>
          <name>Maven snapshot repository</name>
          <url>http://people.apache.org/repo/m2-snapshot-repository</url>
        </repository>
      </repositories>
      <id>defaultprofile</id>
    </profile>
    <profile>
      <repositories>
        <repository>
          <releases />
          <id>thirdparty</id>
          <url>http://192.168.9.27:8081/nexus/content/repositories/thirdparty</url>
        </repository>
      </repositories>
      <id>dev</id>
    </profile>
  </profiles>
  <activeProfiles>
    <activeProfile>nexus</activeProfile>
  </activeProfiles>
  <pluginGroups>
    <pluginGroup>org.apache.maven.plugins</pluginGroup>
    <pluginGroup>org.codehaus.mojo</pluginGroup>
  </pluginGroups>
</settings>
```

仔细观察，发现这里生效的settings中的私库地址配置的是 `http://localhost:8081/nexus/content/groups/public` ，具体为什么和maven的 `conf` 文件夹下 `settings.conf` 不一致，还要进一步研究。

## 解决

编译时指定配置文件即可。命令如下所示：

```cmd
mvn -s F:/DEV/apache-maven-3.2.1/conf/settings.xml clean install -DskipTests -U
```
